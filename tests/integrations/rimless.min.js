var rimless=function(t){"use strict";function e(){return"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope}function n(t){const e=[];return function t(n,r=""){Object.keys(n).forEach(o=>{const i=r?`${r}.${o}`:o;n[o]===Object(n[o])&&t(n[o],i),"function"==typeof n[o]&&e.push(i)})}(t),e}const r=/^(https?:|file:)?\/\/([^/:]+)?(:(\d+))?/,o={"http:":"80","https:":"443"};var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,c=/^\w*$/,u=/^\./,s=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,f=/\\(\\)?/g,l=/^\[object .+?Constructor\]$/,p="object"==typeof i&&i&&i.Object===Object&&i,_="object"==typeof self&&self&&self.Object===Object&&self,h=p||_||Function("return this")();var d,y=Array.prototype,v=Function.prototype,g=Object.prototype,E=h["__core-js_shared__"],S=(d=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+d:"",m=v.toString,b=g.hasOwnProperty,R=g.toString,O=RegExp("^"+m.call(b).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),w=h.Symbol,j=y.splice,A=G(h,"Map"),M=G(Object,"create"),P=w?w.prototype:void 0,C=P?P.toString:void 0;function $(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function L(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function N(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function I(t,e){for(var n,r,o=t.length;o--;)if((n=t[o][0])===(r=e)||n!=n&&r!=r)return o;return-1}function D(t,e){for(var n,r=0,o=(e=function(t,e){if(F(t))return!1;var n=typeof t;if("number"==n||"symbol"==n||"boolean"==n||null==t||Q(t))return!0;return c.test(t)||!a.test(t)||null!=e&&t in Object(e)}(e,t)?[e]:F(n=e)?n:J(n)).length;null!=t&&r<o;)t=t[U(e[r++])];return r&&r==o?t:void 0}function T(t){return!(!K(t)||(e=t,S&&S in e))&&(function(t){var e=K(t)?R.call(t):"";return"[object Function]"==e||"[object GeneratorFunction]"==e}(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?O:l).test(function(t){if(null!=t){try{return m.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var e}function H(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function G(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return T(n)?n:void 0}$.prototype.clear=function(){this.__data__=M?M(null):{}},$.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},$.prototype.get=function(t){var e=this.__data__;if(M){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return b.call(e,t)?e[t]:void 0},$.prototype.has=function(t){var e=this.__data__;return M?void 0!==e[t]:b.call(e,t)},$.prototype.set=function(t,e){return this.__data__[t]=M&&void 0===e?"__lodash_hash_undefined__":e,this},L.prototype.clear=function(){this.__data__=[]},L.prototype.delete=function(t){var e=this.__data__,n=I(e,t);return!(n<0)&&(n==e.length-1?e.pop():j.call(e,n,1),!0)},L.prototype.get=function(t){var e=this.__data__,n=I(e,t);return n<0?void 0:e[n][1]},L.prototype.has=function(t){return I(this.__data__,t)>-1},L.prototype.set=function(t,e){var n=this.__data__,r=I(n,t);return r<0?n.push([t,e]):n[r][1]=e,this},N.prototype.clear=function(){this.__data__={hash:new $,map:new(A||L),string:new $}},N.prototype.delete=function(t){return H(this,t).delete(t)},N.prototype.get=function(t){return H(this,t).get(t)},N.prototype.has=function(t){return H(this,t).has(t)},N.prototype.set=function(t,e){return H(this,t).set(t,e),this};var J=V((function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(Q(t))return C?C.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}(e);var n=[];return u.test(t)&&n.push(""),t.replace(s,(function(t,e,r,o){n.push(r?o.replace(f,"$1"):e||t)})),n}));function U(t){if("string"==typeof t||Q(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function V(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=t.apply(this,r);return n.cache=i.set(o,a),a};return n.cache=new(V.Cache||N),n}V.Cache=N;var F=Array.isArray;function K(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Q(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==R.call(t)}var k=function(t,e,n){var r=null==t?void 0:D(t,e);return void 0===r?n:r},x=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Y=/^\w*$/,W=/^\./,q=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,z=/\\(\\)?/g,B=/^\[object .+?Constructor\]$/,X=/^(?:0|[1-9]\d*)$/,Z="object"==typeof i&&i&&i.Object===Object&&i,tt="object"==typeof self&&self&&self.Object===Object&&self,et=Z||tt||Function("return this")();var nt=Array.prototype,rt=Function.prototype,ot=Object.prototype,it=et["__core-js_shared__"],at=function(){var t=/[^.]+$/.exec(it&&it.keys&&it.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),ct=rt.toString,ut=ot.hasOwnProperty,st=ot.toString,ft=RegExp("^"+ct.call(ut).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),lt=et.Symbol,pt=nt.splice,_t=wt(et,"Map"),ht=wt(Object,"create"),dt=lt?lt.prototype:void 0,yt=dt?dt.toString:void 0;function vt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function gt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Et(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function St(t,e,n){var r=t[e];ut.call(t,e)&&Ct(r,n)&&(void 0!==n||e in t)||(t[e]=n)}function mt(t,e){for(var n=t.length;n--;)if(Ct(t[n][0],e))return n;return-1}function bt(t){return!(!Lt(t)||(e=t,at&&at in e))&&(function(t){var e=Lt(t)?st.call(t):"";return"[object Function]"==e||"[object GeneratorFunction]"==e}(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?ft:B).test(function(t){if(null!=t){try{return ct.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var e}function Rt(t,e,n,r){if(!Lt(t))return t;for(var o=-1,i=(e=function(t,e){if($t(t))return!1;var n=typeof t;if("number"==n||"symbol"==n||"boolean"==n||null==t||Nt(t))return!0;return Y.test(t)||!x.test(t)||null!=e&&t in Object(e)}(e,t)?[e]:function(t){return $t(t)?t:At(t)}(e)).length,a=i-1,c=t;null!=c&&++o<i;){var u=Mt(e[o]),s=n;if(o!=a){var f=c[u];void 0===(s=r?r(f,u,c):void 0)&&(s=Lt(f)?f:jt(e[o+1])?[]:{})}St(c,u,s),c=c[u]}return t}function Ot(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function wt(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return bt(n)?n:void 0}function jt(t,e){return!!(e=null==e?9007199254740991:e)&&("number"==typeof t||X.test(t))&&t>-1&&t%1==0&&t<e}vt.prototype.clear=function(){this.__data__=ht?ht(null):{}},vt.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},vt.prototype.get=function(t){var e=this.__data__;if(ht){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return ut.call(e,t)?e[t]:void 0},vt.prototype.has=function(t){var e=this.__data__;return ht?void 0!==e[t]:ut.call(e,t)},vt.prototype.set=function(t,e){return this.__data__[t]=ht&&void 0===e?"__lodash_hash_undefined__":e,this},gt.prototype.clear=function(){this.__data__=[]},gt.prototype.delete=function(t){var e=this.__data__,n=mt(e,t);return!(n<0)&&(n==e.length-1?e.pop():pt.call(e,n,1),!0)},gt.prototype.get=function(t){var e=this.__data__,n=mt(e,t);return n<0?void 0:e[n][1]},gt.prototype.has=function(t){return mt(this.__data__,t)>-1},gt.prototype.set=function(t,e){var n=this.__data__,r=mt(n,t);return r<0?n.push([t,e]):n[r][1]=e,this},Et.prototype.clear=function(){this.__data__={hash:new vt,map:new(_t||gt),string:new vt}},Et.prototype.delete=function(t){return Ot(this,t).delete(t)},Et.prototype.get=function(t){return Ot(this,t).get(t)},Et.prototype.has=function(t){return Ot(this,t).has(t)},Et.prototype.set=function(t,e){return Ot(this,t).set(t,e),this};var At=Pt((function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(Nt(t))return yt?yt.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}(e);var n=[];return W.test(t)&&n.push(""),t.replace(q,(function(t,e,r,o){n.push(r?o.replace(z,"$1"):e||t)})),n}));function Mt(t){if("string"==typeof t||Nt(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Pt(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=t.apply(this,r);return n.cache=i.set(o,a),a};return n.cache=new(Pt.Cache||Et),n}function Ct(t,e){return t===e||t!=t&&e!=e}Pt.Cache=Et;var $t=Array.isArray;function Lt(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Nt(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==st.call(t)}var It=function(t,e,n){return null==t?t:Rt(t,e,n)},Dt="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),Tt=new Uint8Array(16);function Ht(){if(!Dt)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Dt(Tt)}for(var Gt,Jt,Ut=[],Vt=0;Vt<256;++Vt)Ut[Vt]=(Vt+256).toString(16).substr(1);function Ft(t,e,n){var r=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var o=(t=t||{}).random||(t.rng||Ht)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e)for(var i=0;i<16;++i)e[r+i]=o[i];return e||function(t,e){var n=e||0,r=Ut;return[r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]]].join("")}(o)}function Kt(t={},n=[],r,o){const i=[];return n.forEach(n=>{async function a(i){const{action:a,callID:c,connectionID:u,callName:s,args:f=[]}=i.data;if(a!==Jt.RPC_REQUEST)return;if(!c||!s)return;if(s!==n)return;if(u!==r)return;const l={action:Jt.RPC_RESOLVE,callID:c,callName:s,connectionID:u,error:null,result:null};try{const e=await k(t,n)(...f);l.result=JSON.parse(JSON.stringify(e))}catch(t){l.error=JSON.parse(JSON.stringify(t,Object.getOwnPropertyNames(t)))}o?o.postMessage(l):e()?self.postMessage(l):i.source.postMessage(l,i.origin)}o?o.addEventListener(Gt.MESSAGE,a):self.addEventListener(Gt.MESSAGE,a),i.push(()=>self.removeEventListener(Gt.MESSAGE,a))}),()=>i.forEach(t=>t())}function Qt(t={},n=[],r,o,i){const a={...t},c=[];return n.forEach(t=>{const n=function(t,n,r,o=[],i){return(...a)=>new Promise((c,u)=>{const s=Ft();function f(e){const{callID:r,connectionID:o,callName:i,result:a,error:s,action:f}=e.data;if(r&&i&&i===t&&o===n)return f===Jt.RPC_RESOLVE?c(a):f===Jt.RPC_REJECT?u(s):void 0}const l={action:Jt.RPC_REQUEST,args:JSON.parse(JSON.stringify(a)),callID:s,callName:t,connectionID:n};i?i.addEventListener(Gt.MESSAGE,f):self.addEventListener(Gt.MESSAGE,f),o.push(()=>self.removeEventListener(Gt.MESSAGE,f)),i?i.postMessage(l):e()?self.postMessage(l):(r.source||r.target).postMessage(l,r.origin)})}(t,r,o,c,i);It(a,t,n)}),{remote:a,unregisterRemote:()=>c.forEach(t=>t())}}!function(t){t.MESSAGE="message"}(Gt||(Gt={})),function(t){t.HANDSHAKE_REQUEST="RIMLESS/HANDSHAKE_REQUEST",t.HANDSHAKE_REPLY="RIMLESS/HANDSHAKE_REPLY",t.RPC_REQUEST="RIMLESS/RPC_REQUEST",t.RPC_RESOLVE="RIMLESS/RPC_RESOLVE",t.RPC_REJECT="RIMLESS/RPC_REJECT"}(Jt||(Jt={}));let kt=null,xt=!1;var Yt={connect:function(t={},r={}){return new Promise((r,o)=>{const i=n(t);self.addEventListener(Gt.MESSAGE,(function e(n){if(n.data.action!==Jt.HANDSHAKE_REPLY)return;const o=Kt(t,i,n.data.connectionID),{remote:a,unregisterRemote:c}=Qt(n.data.schema,n.data.methods,n.data.connectionID,n);return xt=!0,r({remote:a,close:()=>{self.removeEventListener(Gt.MESSAGE,e),c(),o()}})}));const a={action:Jt.HANDSHAKE_REQUEST,methods:i,schema:JSON.parse(JSON.stringify(t))};kt=setInterval(()=>{if(xt)return clearInterval(kt);e()?self.postMessage(a):window.parent.postMessage(a,"*")},600),setTimeout(()=>{xt||o("connection timeout")},3e3)})}};function Wt(t,e){const n=function(t){const{location:e}=document,n=r.exec(t||"");let i,a,c;return n?[,i=e.protocol,a,,c]=n:(i=e.protocol,a=e.hostname,c=e.port),"file:"===i?"null":`${i}//${a}${c&&c!==o[i]?":"+c:""}`}(t.getAttribute("src")),i=e.origin===n,a=e.source===t.contentWindow;return i&&a}var qt={connect:function(t,e={},r){if(!t)throw new Error("a target is required");const o=void 0!==t.onerror&&void 0!==t.onmessage,i=o?t:window;return new Promise((r,a)=>{const c=Ft();i.addEventListener(Gt.MESSAGE,(function a(u){if(!o&&!Wt(t,u))return;if(u.data.action!==Jt.HANDSHAKE_REQUEST)return;const s=n(e),f=Kt(e,s,c,o?t:void 0),{remote:l,unregisterRemote:p}=Qt(u.data.schema,u.data.methods,c,u,o?t:void 0),_={action:Jt.HANDSHAKE_REPLY,connectionID:c,methods:s,schema:JSON.parse(JSON.stringify(e))};return o?t.postMessage(_):u.source.postMessage(_,u.origin),r({remote:l,close:()=>{i.removeEventListener(Gt.MESSAGE,a),p(),f()}})}))})}};return t.guest=Yt,t.host=qt,t}({});
//# sourceMappingURL=rimless.min.js.map
